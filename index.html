<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Voice Translator Pro</title>
<style>
body {
  font-family: Arial, sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
  margin: 0;
  padding: 20px;
  background: linear-gradient(135deg,#1f1c2c,#928dab);
  color: #fff;
}
h2 { margin-bottom: 20px; }
button {
  font-size: 20px;
  padding: 15px 30px;
  border-radius: 12px;
  border: none;
  background: #4caf50;
  color: white;
  margin-bottom: 10px;
  width: 90%;
  max-width: 400px;
}
select {
  padding: 10px;
  font-size: 16px;
  margin: 5px;
  border-radius: 8px;
  border: none;
}
textarea {
  width: 90%;
  max-width: 400px;
  height: 200px;
  font-size: 18px;
  padding: 10px;
  border-radius: 12px;
  border: none;
  resize: none;
  margin-bottom: 15px;
}
#error {
  color: #ff5555;
  font-size: 14px;
}
</style>
</head>
<body>

<h2>ğŸ¤ Voice Translator Pro</h2>

<select id="sourceLang">
  <option value="ar">Arabic</option>
  <option value="en">English</option>
  <option value="fr">French</option>
  <option value="es">Spanish</option>
  <option value="de">German</option>
  <option value="zh">Chinese</option>
  <option value="ja">Japanese</option>
  <option value="hi">Hindi</option>
  <!-- Ø£Ø¶Ù Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù„ØºØ§Øª Ø­Ø³Ø¨ MyMemory Ø£Ùˆ Google Translate -->
</select>

<select id="targetLang">
  <option value="en">English</option>
  <option value="ar">Arabic</option>
  <option value="fr">French</option>
  <option value="es">Spanish</option>
  <option value="de">German</option>
  <option value="zh">Chinese</option>
  <option value="ja">Japanese</option>
  <option value="hi">Hindi</option>
</select>

<button id="startBtn">ğŸ¤ Ø³Ø¬Ù„ Ø§Ù„ÙƒÙ„Ø§Ù…</button>
<button id="translateBtn">ğŸŒ ØªØ±Ø¬Ù…Ø©</button>

<textarea id="translated" placeholder="Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§..." readonly></textarea>
<div id="error"></div>

<script>
const startBtn = document.getElementById("startBtn");
const translateBtn = document.getElementById("translateBtn");
const translatedArea = document.getElementById("translated");
const errorDiv = document.getElementById("error");
const sourceLang = document.getElementById("sourceLang");
const targetLang = document.getElementById("targetLang");

const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
let recognition;
let recordedText = "";

if(!SpeechRecognition){
  errorDiv.textContent = "Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¥Ù…Ù„Ø§Ø¡ Ø§Ù„ØµÙˆØªÙŠ (Web Speech API).";
}

// ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØµÙˆØª
startBtn.addEventListener("click", ()=>{
  errorDiv.textContent = "";
  if(!SpeechRecognition) return;
  recordedText = "";
  recognition = new SpeechRecognition();
  recognition.lang = sourceLang.value;
  recognition.interimResults = false;
  recognition.continuous = false; // ÙŠØ³Ø¬Ù„ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·

  recognition.start();

  recognition.onresult = e=>{
    recordedText = e.results[0][0].transcript;
  };

  recognition.onerror = e=>{
    let msg = "";
    switch(e.error){
      case "not-allowed": msg="ØªÙ… Ø±ÙØ¶ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ†."; break;
      case "no-speech": msg="Ù„Ù… ÙŠØªÙ… Ø³Ù…Ø§Ø¹ Ø£ÙŠ ÙƒÙ„Ø§Ù…."; break;
      case "aborted": msg="ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ³Ø¬ÙŠÙ„."; break;
      default: msg="Ø­Ø¯Ø« Ø®Ø·Ø£: "+e.error;
    }
    errorDiv.textContent = msg;
  };
});

// ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø³Ø¬Ù„
translateBtn.addEventListener("click", async ()=>{
  if(recordedText.trim() === "") {
    errorDiv.textContent = "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Øµ Ù„ØªØ±Ø¬Ù…ØªÙ‡!";
    return;
  }
  errorDiv.textContent = "";
  const target = targetLang.value;
  const url = `https://api.mymemory.translated.net/get?q=${encodeURIComponent(recordedText)}&langpair=${sourceLang.value}|${target}`;

  try{
    const res = await fetch(url);
    const data = await res.json();
    const translation = data.responseData.translatedText;
    translatedArea.value = translation;

    // Ù†Ø·Ù‚ Ø§Ù„ØªØ±Ø¬Ù…Ø© Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©
    const utter = new SpeechSynthesisUtterance(translation);
    utter.lang = target;
    window.speechSynthesis.speak(utter);

  }catch(e){
    errorDiv.textContent = "Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ±Ø¬Ù…Ø©: "+e.message;
  }
});
</script>

</body>
</html>