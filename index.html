<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ultimate Voice Translator</title>

<style>
:root{
  --grad1:#ff6b6b;
  --grad2:#feca57;
  --grad3:#48dbfb;
  --grad4:#1dd1a1;
  --card:#1e293b;
  --text:#ffffff;
  --muted:#cbd5e1;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:"Segoe UI",Roboto,Arial,sans-serif;
  background:linear-gradient(135deg,var(--grad1),var(--grad2),var(--grad3),var(--grad4));
  color:var(--text);
  min-height:100vh;
}
header{padding:16px;text-align:center;}
.app-header{display:flex;align-items:center;justify-content:center;gap:12px;}
.app-icon{width:50px;height:50px;border-radius:12px;}
.app-title{font-size:26px;font-weight:700;}
.tabs{display:flex;margin:10px;}
.tabs button{flex:1;padding:12px;margin:2px;border:none;border-radius:12px;font-size:14px;cursor:pointer;transition:.3s;}
.tabs button.active{background:linear-gradient(135deg,#fff,#f1f2f6);color:#222;font-weight:700;}
.section{display:none;padding:16px;}
.section.active{display:block;}
.card{background:rgba(30,41,59,.9);border-radius:16px;padding:16px;box-shadow:0 10px 25px rgba(0,0,0,.25);margin-bottom:16px;}
textarea,input,select{width:100%;padding:12px;margin:10px 0;border-radius:12px;border:none;font-size:16px;}
textarea{min-height:140px;}
.action{background:linear-gradient(135deg,#6c5ce7,#00cec9);border:none;padding:14px;border-radius:14px;font-size:18px;width:100%;color:white;cursor:pointer;margin-top:10px;}
#loader{position:fixed;inset:0;background:rgba(0,0,0,.75);display:none;align-items:center;justify-content:center;flex-direction:column;z-index:999;}
#emoji{font-size:60px;animation:bounce 1s infinite;}
@keyframes bounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-14px)}}
#progress{width:70%;height:8px;background:#444;border-radius:10px;margin-top:20px;overflow:hidden;}
#bar{height:100%;width:0%;background:linear-gradient(135deg,#6c5ce7,#00cec9);transition:width .4s;}
#loaderText{margin-top:14px;font-size:16px;}
#resultText{background:rgba(255,255,255,0.1);padding:10px;border-radius:12px;min-height:100px;color:#fff;white-space:pre-wrap;}
.copyBtn{margin-top:6px;padding:8px 12px;border:none;border-radius:10px;background:#fd79a8;color:#fff;cursor:pointer;}
</style>
</head>

<body>
<header>
  <div class="app-header">
    <img class="app-icon" src="https://cdn-icons-png.flaticon.com/512/3898/3898082.png">
    <div class="app-title">Ultimate Voice Translator</div>
  </div>
</header>

<div class="tabs">
  <button class="active" onclick="tab(0)">ğŸ“ Text â†’ Speech</button>
  <button onclick="tab(1)">ğŸ¤ Speech â†’ Text</button>
  <button onclick="tab(2)">ğŸ—£ Speech â†’ Speech</button>
</div>

<!-- Text â†’ Speech -->
<div class="section active">
  <div class="card">
    <textarea id="textInput" placeholder="Type text to translate & speak..."></textarea>
    <select id="toLang"></select>
    <button class="action" onclick="translateTextToSpeech()">ğŸŒ Translate & Speak</button>
    <div id="resultText"></div>
    <button class="copyBtn" onclick="copyText()">ğŸ“‹ Copy</button>
  </div>
</div>

<!-- Speech â†’ Text -->
<div class="section">
  <div class="card">
    <button class="action" onclick="speechToText()">ğŸ¤ Start Listening & Translate</button>
    <select id="toLangSTT"></select>
    <div id="resultTextSTT"></div>
    <button class="copyBtn" onclick="copyTextSTT()">ğŸ“‹ Copy</button>
  </div>
</div>

<!-- Speech â†’ Speech -->
<div class="section">
  <div class="card">
    <button class="action" onclick="speechToSpeech()">ğŸ¤ Speak & Translate to Voice</button>
    <select id="toLangSTS"></select>
    <div id="resultTextSTS"></div>
    <button class="copyBtn" onclick="copyTextSTS()">ğŸ“‹ Copy</button>
  </div>
</div>

<!-- Loader -->
<div id="loader">
  <div id="emoji">â³</div>
  <div id="progress"><div id="bar"></div></div>
  <div id="loaderText">Processing...</div>
</div>

<script>
let lastText="";
const languages=[["en","English"],["ar","Arabic"],["fr","French"],["es","Spanish"],["de","German"],["it","Italian"],["pt","Portuguese"],["ru","Russian"],["tr","Turkish"],["hi","Hindi"],["zh","Chinese"],["ja","Japanese"],["ko","Korean"],["id","Indonesian"],["ur","Urdu"]];

const selects=[toLang,toLangSTT,toLangSTS];
selects.forEach(sel=>{
  languages.forEach(l=>sel.innerHTML+=`<option value="${l[0]}">${l[1]}</option>`);
});
toLang.value="en"; toLangSTT.value="en"; toLangSTS.value="en";

/* Tabs */
function tab(i){
  document.querySelectorAll(".section").forEach((s,n)=>s.classList.toggle("active",n===i));
  document.querySelectorAll(".tabs button").forEach((b,n)=>b.classList.toggle("active",n===i));
}

/* Loader */
function showLoader(text,emoji="â³",p=30){ loader.style.display="flex"; loaderText.textContent=text; document.getElementById("emoji").textContent=emoji; bar.style.width=p+"%";}
function updateProgress(p){ bar.style.width=p+"%"; }
function hideLoader(){ loader.style.display="none"; bar.style.width="0%"; }

/* Speech */
let synth=window.speechSynthesis,utter;
function speak(text,lang){
  lastText=text;
  showLoader("ğŸ”Š Speaking...","ğŸ—£ï¸",90);
  synth.cancel();
  utter=new SpeechSynthesisUtterance(text);
  utter.lang=lang;
  utter.onend=hideLoader;
  synth.speak(utter);
}

/* Translate function (LibreTranslate) */
async function translateText(text,to){
  showLoader("ğŸ”„ Translating...","ğŸ”„",40);
  try{
    const res=await fetch("https://libretranslate.de/translate",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({q:text,source:"auto",target:to,format:"text"})
    });
    const data=await res.json();
    hideLoader();
    return data.translatedText;
  }catch(e){ hideLoader(); alert("Translation failed:"+e); return text; }
}

/* Text â†’ Speech */
async function translateTextToSpeech(){
  const text=textInput.value.trim();
  const to=toLang.value;
  if(!text) return alert("Enter text!");
  showLoader("Translating & Speaking...","ğŸ”„",30);
  const translated=await translateText(text,to);
  document.getElementById("resultText").textContent=translated;
  speak(translated,to);
}

/* Speech â†’ Text */
function speechToText(){
  const R=window.SpeechRecognition||webkitSpeechRecognition;
  if(!R) return alert("Speech recognition not supported");
  const r=new R();
  r.lang="en-US";
  showLoader("ğŸ¤ Listening...","ğŸ¤",20);
  r.onresult=async e=>{
    const text=e.results[0][0].transcript;
    const to=toLangSTT.value;
    const translated=await translateText(text,to);
    document.getElementById("resultTextSTT").textContent=translated;
    hideLoader();
  };
  r.onerror=e=>{ hideLoader(); alert(e.error); }
  r.start();
}

/* Speech â†’ Speech */
function speechToSpeech(){
  const R=window.SpeechRecognition||webkitSpeechRecognition;
  if(!R) return alert("Speech recognition not supported");
  const r=new R();
  r.lang="en-US";
  showLoader("ğŸ¤ Listening & Translating...","ğŸ¤",20);
  r.onresult=async e=>{
    const text=e.results[0][0].transcript;
    const to=toLangSTS.value;
    const translated=await translateText(text,to);
    document.getElementById("resultTextSTS").textContent=translated;
    speak(translated,to);
  };
  r.onerror=e=>{ hideLoader(); alert(e.error); }
  r.start();
}

/* Copy functions */
function copyText(){navigator.clipboard.writeText(document.getElementById("resultText").textContent);}
function copyTextSTT(){navigator.clipboard.writeText(document.getElementById("resultTextSTT").textContent);}
function copyTextSTS(){navigator.clipboard.writeText(document.getElementById("resultTextSTS").textContent);}
</script>
</body>
</html>