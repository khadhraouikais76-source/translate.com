<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Universal Translator</title>

<script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
<script src="https://unpkg.com/mammoth/mammoth.browser.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.122/pdf.min.js"></script>

<style>
:root{
  --primary:#6c63ff;
  --secondary:#00c9a7;
  --bg1:#0f2027;
  --bg2:#203a43;
  --bg3:#2c5364;
  --card:#1e293b;
  --text:#ffffff;
  --muted:#cbd5e1;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:"Segoe UI",Roboto,Arial,sans-serif;
  background:linear-gradient(135deg,var(--bg1),var(--bg2),var(--bg3));
  color:var(--text);
  min-height:100vh;
}
header{padding:16px;text-align:center;}
.app-header{display:flex;align-items:center;justify-content:center;gap:12px;}
.app-icon{width:44px;height:44px;border-radius:12px;}
.app-title{font-size:24px;font-weight:700;}
.tabs{display:flex;background:rgba(0,0,0,.25);backdrop-filter:blur(6px);}
.tabs button{flex:1;padding:14px 6px;border:none;background:none;color:var(--muted);font-size:14px;cursor:pointer;transition:.3s;}
.tabs button:hover{background:rgba(255,255,255,0.1);}
.tabs button.active{color:#fff;background:linear-gradient(135deg,var(--primary),var(--secondary));}
.section{display:none;padding:16px;}
.section.active{display:block;}
.card{background:var(--card);border-radius:16px;padding:16px;box-shadow:0 10px 25px rgba(0,0,0,.25);margin-bottom:16px;}
textarea,input,select{width:100%;padding:12px;margin:10px 0;border-radius:12px;border:none;font-size:16px;}
textarea{min-height:140px}
.action{background:linear-gradient(135deg,var(--primary),var(--secondary));border:none;padding:14px;border-radius:14px;font-size:18px;width:100%;color:white;cursor:pointer;margin-top:10px;}
.controls{display:flex;justify-content:space-around;margin-top:10px;}
.controls button{flex:1;margin:5px;padding:12px;border:none;border-radius:12px;font-size:16px;cursor:pointer;}
#error{color:#ff6b6b;margin:10px;text-align:center;}
#loader{position:fixed;inset:0;background:rgba(0,0,0,.75);display:none;align-items:center;justify-content:center;flex-direction:column;z-index:999;}
#emoji{font-size:60px;animation:bounce 1s infinite;}
@keyframes bounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-14px)}}
#progress{width:70%;height:8px;background:#444;border-radius:10px;margin-top:20px;overflow:hidden;}
#bar{height:100%;width:0%;background:linear-gradient(135deg,var(--primary),var(--secondary));transition:width .4s;}
#loaderText{margin-top:14px;font-size:16px;}
</style>
</head>

<body>
<header>
  <div class="app-header">
    <img class="app-icon" src="https://cdn-icons-png.flaticon.com/512/3898/3898082.png">
    <div class="app-title">Universal Translator</div>
  </div>
</header>

<div class="tabs">
  <button class="active" onclick="tab(0)">üé§ Voice</button>
  <button onclick="tab(1)">üìù Text</button>
  <button onclick="tab(2)">üñº Image</button>
  <button onclick="tab(3)">üìÇ File</button>
  <button onclick="tab(4)">‚öô Settings</button>
</div>

<!-- VOICE -->
<div class="section active">
  <div class="card">
    <button class="action" onclick="startVoice()">üé§ Speak & Translate</button>
  </div>
</div>

<!-- TEXT -->
<div class="section">
  <div class="card">
    <textarea id="textInput" placeholder="Type or paste text here..."></textarea>
    <button class="action" onclick="translateText()">üåê Translate & Speak</button>
  </div>
</div>

<!-- IMAGE -->
<div class="section">
  <div class="card">
    <input type="file" accept="image/*" onchange="selectedImage=this.files[0];">
    <button class="action" onclick="processImage()">üåê Translate & Speak</button>
  </div>
</div>

<!-- FILE -->
<div class="section">
  <div class="card">
    <input type="file" accept=".txt,.docx,.pdf" onchange="selectedFile=this.files[0];">
    <button class="action" onclick="processFile()">üåê Translate & Speak</button>
  </div>
</div>

<!-- SETTINGS -->
<div class="section">
  <div class="card">
    <label>From language</label>
    <select id="fromLang"></select>
    <label>To language</label>
    <select id="toLang"></select>
    <div class="controls">
      <button onclick="pause()">‚è∏ Pause</button>
      <button onclick="resume()">‚ñ∂ Resume</button>
      <button onclick="stop()">‚èπ Stop</button>
    </div>
  </div>
</div>

<div id="error"></div>

<!-- LOADER -->
<div id="loader">
  <div id="emoji">‚è≥</div>
  <div id="progress"><div id="bar"></div></div>
  <div id="loaderText">Processing...</div>
</div>

<script>
let lastText="", selectedFile=null, selectedImage=null;
const languages=[["en","English"],["ar","Arabic"],["fr","French"],["es","Spanish"],["de","German"],["it","Italian"],["pt","Portuguese"],["ru","Russian"],["tr","Turkish"],["hi","Hindi"],["zh-CN","Chinese"],["ja","Japanese"],["ko","Korean"],["id","Indonesian"],["ur","Urdu"]];
languages.forEach(l=>{fromLang.innerHTML+=`<option value="${l[0]}">${l[1]}</option>`; toLang.innerHTML+=`<option value="${l[0]}">${l[1]}</option>`;});
toLang.value="en";

/* TABS */
function tab(i){
  document.querySelectorAll(".section").forEach((s,n)=>s.classList.toggle("active",n===i));
  document.querySelectorAll(".tabs button").forEach((b,n)=>b.classList.toggle("active",n===i));
}

/* LOADER */
function showLoader(text,emoji="‚è≥",p=30){ loader.style.display="flex"; loaderText.textContent=text; document.getElementById("emoji").textContent=emoji; bar.style.width=p+"%";}
function updateProgress(p){ bar.style.width=p+"%"; }
function hideLoader(){ loader.style.display="none"; bar.style.width="0%"; }

/* SPEECH */
let synth=window.speechSynthesis,utter;
function speak(text,lang){ lastText=text; showLoader("üîä Speaking...","üó£Ô∏è",90); synth.cancel(); utter=new SpeechSynthesisUtterance(text); utter.lang=lang; utter.onend=hideLoader; synth.speak(utter);}
function pause(){synth.pause();}
function resume(){synth.resume();}
function stop(){synth.cancel(); hideLoader();}

/* TRANSLATE */
async function translate(text){
  if(!text.trim()){ error.textContent="No text to translate"; return; }
  lastText=text;
  showLoader("üîÑ Translating...","üîÑ",40);
  try{
    const r=await fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=${fromLang.value}|${toLang.value}`);
    updateProgress(70);
    const d=await r.json();
    speak(d.responseData.translatedText,toLang.value);
  }catch{hideLoader(); error.textContent="Translation error";}
}
function repeatLastText(){ if(lastText) translate(lastText); }
function translateText(){ translate(textInput.value); }

/* VOICE */
function startVoice(){
  const R=window.SpeechRecognition||webkitSpeechRecognition;
  if(!R){ error.textContent="Speech not supported"; return; }
  showLoader("üé§ Listening...","üé§",20);
  const r=new R(); r.lang=fromLang.value;
  r.onresult=e=>translate(e.results[0][0].transcript);
  r.onerror=e=>{ hideLoader(); error.textContent=e.error; }
  r.start();
}

/* IMAGE */
function processImage(){
  if(!selectedImage){ error.textContent="No image selected"; return; }
  showLoader("üñºÔ∏è OCR...","üñºÔ∏è",20);
  Tesseract.recognize(selectedImage,'ara+eng')
    .then(r=>translate(r.data.text))
    .catch(()=>{ hideLoader(); error.textContent="OCR failed"; });
}

/* FILE */
function processFile(){
  if(!selectedFile){ error.textContent="No file selected"; return; }
  showLoader("üìÇ Reading file...","üìÇ",20);
  const f=selectedFile;
  if(f.name.endsWith(".txt")){
    const r=new FileReader(); r.onload=e=>translate(e.target.result); r.readAsText(f);
  }else if(f.name.endsWith(".docx")){
    const r=new FileReader(); r.onload=e=>{ mammoth.extractRawText({arrayBuffer:e.target.result}).then(res=>translate(res.value)).catch(()=>{ hideLoader(); error.textContent="DOCX failed"; }); }; r.readAsArrayBuffer(f);
  }else if(f.name.endsWith(".pdf")){
    const r=new FileReader(); r.onload=async e=>{
      const typedarray=new Uint8Array(e.target.result);
      const pdf=await pdfjsLib.getDocument(typedarray).promise;
      let fullText="";
      for(let p=1;p<=pdf.numPages;p++){
        const page=await pdf.getPage(p);
        const txt=await page.getTextContent();
        fullText+=txt.items.map(i=>i.str).join(" ")+"\n";
        updateProgress(Math.floor((p/pdf.numPages)*70)+20);
      }
      translate(fullText);
    }; r.readAsArrayBuffer(f);
  }else{ hideLoader(); error.textContent="Unsupported file type"; }
}
</script>
</body>
</html>