<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Voice Translator Pro</title>
<style>
body {
  font-family: Arial, sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
  margin: 0;
  padding: 20px;
  background: linear-gradient(135deg,#1f1c2c,#928dab);
  color: #fff;
}
h2 { margin-bottom: 20px; }
button {
  font-size: 20px;
  padding: 15px 30px;
  border-radius: 12px;
  border: none;
  background: #4caf50;
  color: white;
  margin-bottom: 20px;
  width: 90%;
  max-width: 400px;
}
select {
  padding: 10px;
  font-size: 16px;
  margin: 5px;
  border-radius: 8px;
  border: none;
}
textarea {
  width: 90%;
  max-width: 400px;
  height: 150px;
  font-size: 18px;
  padding: 10px;
  border-radius: 12px;
  border: none;
  resize: none;
  margin-bottom: 15px;
}
#translated {
  width: 90%;
  max-width: 400px;
  min-height: 50px;
  font-size: 18px;
  padding: 10px;
  border-radius: 12px;
  background: rgba(255,255,255,0.1);
  margin-bottom: 15px;
}
#error {
  color: #ff5555;
  font-size: 14px;
}
</style>
</head>
<body>

<h2>ğŸ¤ Voice Translator Pro</h2>

<select id="sourceLang">
  <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
  <option value="en">Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</option>
  <option value="fr">Ø§Ù„ÙØ±Ù†Ø³ÙŠØ©</option>
</select>

<select id="targetLang">
  <option value="en">Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</option>
  <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
  <option value="fr">Ø§Ù„ÙØ±Ù†Ø³ÙŠØ©</option>
</select>

<button id="startBtn">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ø¯Ø«</button>

<textarea id="output" placeholder="Ø³ÙŠØªÙ… ÙƒØªØ§Ø¨Ø© ÙƒÙ„Ø§Ù…Ùƒ Ù‡Ù†Ø§..." readonly></textarea>
<div id="translated" placeholder="Ø§Ù„ØªØ±Ø¬Ù…Ø© ØªØ¸Ù‡Ø± Ù‡Ù†Ø§..."></div>
<div id="error"></div>

<script>
const startBtn = document.getElementById("startBtn");
const output = document.getElementById("output");
const translatedDiv = document.getElementById("translated");
const errorDiv = document.getElementById("error");
const sourceLang = document.getElementById("sourceLang");
const targetLang = document.getElementById("targetLang");

const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

if(!SpeechRecognition){
  errorDiv.textContent = "Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¥Ù…Ù„Ø§Ø¡ Ø§Ù„ØµÙˆØªÙŠ (Web Speech API).";
}

let recognition;

startBtn.addEventListener("click", ()=>{
  errorDiv.textContent = "";
  if(!SpeechRecognition) return;

  try{
    recognition = new SpeechRecognition();
    recognition.lang = sourceLang.value;
    recognition.interimResults = false;
    recognition.continuous = true;

    recognition.start();

    recognition.onresult = async (event)=>{
      const text = event.results[event.results.length-1][0].transcript;
      output.value += text + " ";

      // ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù†Øµ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… MyMemory API
      const target = targetLang.value;
      const url = `https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=${sourceLang.value}|${target}`;

      try{
        const res = await fetch(url);
        const data = await res.json();
        const translation = data.responseData.translatedText;
        translatedDiv.textContent = translation;

        // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Øµ Ø§Ù„Ù…ØªØ±Ø¬Ù… Ø¥Ù„Ù‰ ØµÙˆØª
        const utter = new SpeechSynthesisUtterance(translation);
        utter.lang = target;
        window.speechSynthesis.speak(utter);

      }catch(e){
        errorDiv.textContent = "Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ±Ø¬Ù…Ø©: "+e.message;
      }
    };

    recognition.onerror = (e)=>{
      let msg = "";
      switch(e.error){
        case "not-allowed": msg="ØªÙ… Ø±ÙØ¶ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ†."; break;
        case "service-not-allowed": msg="Ø®Ø¯Ù…Ø© Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØª ØºÙŠØ± Ù…ØªØ§Ø­Ø©."; break;
        case "no-speech": msg="Ù„Ù… ÙŠØªÙ… Ø³Ù…Ø§Ø¹ Ø£ÙŠ ÙƒÙ„Ø§Ù…."; break;
        case "aborted": msg="ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ³Ø¬ÙŠÙ„."; break;
        default: msg="Ø­Ø¯Ø« Ø®Ø·Ø£: "+e.error;
      }
      errorDiv.textContent = msg;
    };

  }catch(err){
    errorDiv.textContent = "Ø®Ø·Ø£ Ø¯Ø§Ø®Ù„ÙŠ: "+err.message;
  }
});
</script>

</body>
</html>